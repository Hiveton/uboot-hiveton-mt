<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firmware Update | HiGoOS U-Boot</title>
    <link rel="stylesheet" href="/style.css">
    <script src="/main.js"></script>
</head>
<body onload="startup()">
    <div class="app-container">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>‚ö° HiGoOS U-Boot</h2>
                <div class="subtitle">Failsafe Recovery</div>
            </div>
            
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Main</div>
                    <a href="/index.html" class="nav-item active">
                        <span class="icon">üì¶</span>
                        <span>Firmware Update</span>
                    </a>
                    <a href="/initramfs.html" class="nav-item">
                        <span class="icon">üöÄ</span>
                        <span>Boot Initramfs</span>
                    </a>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">Advanced</div>
                    <a href="/bl2.html" class="nav-item">
                        <span class="icon">üîß</span>
                        <span>BL2 Preloader</span>
                    </a>
                    <a href="/uboot.html" class="nav-item">
                        <span class="icon">‚öôÔ∏è</span>
                        <span>U-Boot</span>
                    </a>
                    <a href="/gpt.html" class="nav-item">
                        <span class="icon">üíæ</span>
                        <span>GPT Partition</span>
                    </a>
                </div>
            </nav>
            
            <div class="sidebar-footer" id="version"></div>
            <div style="text-align: center; padding: 12px; color: var(--text-secondary); font-size: 10px; border-top: 1px solid var(--border-color);">
                <a href="http://www.hiveton.com" target="_blank" style="color: var(--accent-blue); text-decoration: none;">Hiveton</a> HiGoOS U-BOOT 2026
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="page-header">
                <h1>Firmware Update</h1>
                <p>Upload and install firmware image to your device</p>
            </div>

            <!-- Upload Card -->
            <div class="card" id="upload-card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="icon blue">üì¶</span>
                        <span>Upload Firmware</span>
                    </div>
                </div>

                <form id="form">
                    <!-- MTD Layout Selection -->
                    <div id="mtd_layout" class="hidden">
                        <div class="form-group">
                            <label class="form-label">MTD Layout Configuration</label>
                            <div id="current_mtd_layout" style="margin-bottom: 12px; color: var(--text-secondary);"></div>
                            <select id="mtd_layout_label" name="mtd_layout_label">
                                <!-- Options populated by JS -->
                            </select>
                        </div>
                    </div>

                    <!-- File Input -->
                    <div class="form-group">
                        <label class="form-label">Select Firmware File</label>
                        <div class="file-input-wrapper">
                            <input id="file" type="file" name="firmware" accept=".bin,.img,.trx">
                        </div>
                    </div>

                    <!-- Upload Button -->
                    <button type="button" class="btn btn-primary btn-lg" onclick="upload('firmware')">
                        <span>üì§</span>
                        <span>Upload Firmware</span>
                    </button>
                </form>
            </div>

            <!-- Progress Card (Hidden initially) -->
            <div class="card hidden" id="progress-card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="icon blue">‚è≥</span>
                        <span>Upload Progress</span>
                    </div>
                </div>
                
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
                    </div>
                    <div class="progress-text" id="progress-text">0%</div>
                </div>
            </div>

            <!-- File Info Card (Hidden initially) -->
            <div class="card hidden" id="info-card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="icon green">üìã</span>
                        <span>File Information</span>
                    </div>
                </div>
                
                <div class="info-grid">
                    <div class="info-item">
                        <div class="icon-box blue">üìè</div>
                        <div>
                            <div class="label">File Size</div>
                            <div class="value" id="size">-</div>
                        </div>
                    </div>
                    
                    <div class="info-item">
                        <div class="icon-box purple">üîê</div>
                        <div>
                            <div class="label">MD5 Checksum</div>
                            <div class="value" id="md5">-</div>
                        </div>
                    </div>
                    
                    <div class="info-item hidden" id="mtd-info-item">
                        <div class="icon-box green">üéØ</div>
                        <div>
                            <div class="label">MTD Layout</div>
                            <div class="value" id="mtd">-</div>
                        </div>
                    </div>
                </div>

                <div id="upgrade" class="hidden" style="text-align: center; margin-top: 24px;">
                    <p style="color: var(--accent-green); margin-bottom: 16px;">
                        ‚úÖ All information verified. Ready to update.
                    </p>
                    <button class="btn btn-success btn-lg" onclick="location = '/flashing.html'">
                        <span>üöÄ</span>
                        <span>Start Update</span>
                    </button>
                </div>
            </div>

            <!-- Footer -->
            <div style="text-align: center; padding: 20px; color: var(--text-secondary); font-size: 12px; border-top: 1px solid var(--border-color); margin-top: 20px;">
                Hiveton HiGoOS U-BOOT 2026
            </div>

            <!-- Warning Card -->
            <div class="card alert alert-warning">
                <div class="alert-title">
                    <span>‚ö†Ô∏è</span>
                    <span>Important Warnings</span>
                </div>
                <ul>
                    <li>Do not power off the device during the update process</li>
                    <li>Device will restart automatically when update completes</li>
                    <li>Ensure you are using the correct firmware image for your device model</li>
                    <li>Interrupting the update may cause device to become unbootable</li>
                </ul>
            </div>
        </main>
    </div>
</body>
</html>
